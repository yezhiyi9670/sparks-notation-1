---
title: 更新日志
---

import { New, Fix, Mod, Del, Important, Source } from '@site/src/mdx/changelog/changelog-tags'

<div class="theme-doc-markdown markdown">

# 更新日志 {#changelogs}

:::tip 征集想法：Sparks NMN 2

全新 Sparks NMN 2 正在设计中，如果你有关于语法、交互体验、显示效果等方面的建议，也欢迎通过 GitHub Issues 提交。Sparks NMN 2 的标准**不需要**与当前的 Sparks NMN 兼容，后续会提供相应转换工具转换原有的乐谱。当然，现在你可以放心使用第一代，因为第二代发布后，第一代仍然会继续进行维护性更新。

:::

<!--
可能存在的未修复问题：

1.15.6
- 自定义标点的修复仍然存在一个不影响使用的小问题，即游离 `>` 符号的处理。问题位于 LyricsParser.ts L221。
- 考虑使双引号引起的 `%` `_` 字符不再表示占位符。

1.14.17
- 未标号歌词行的选择机制：经过小节的次数在经过 reset 时应当重置，但是这里没有重置。
-->

:::note 备注

下面更新日志中指向历史源代码的链接仅供参考，不建议自行编译使用。\
部分旧版本的桌面版软件可以在 [GitHub Releases](https://github.com/yezhiyi9670/sparks-notation-1/releases) 中直接下载，如确实有使用旧版的需要，请自行查看。

:::

## 1.15.x

### 未标记 <Source to='https://github.com/yezhiyi9670/sparks-notation-1' />

- <Del/> <Important/> 网站：从文档中删除所有 1.15.1 版本之前的历史内容。
  - 如果你目前使用的是更早的版本，推荐你更新。
  - 如果确实有查阅历史文档的需要，请[查看或编译 1.15.2 版本的网站源代码](https://github.com/yezhiyi9670/sparks-notation-1/tree/445b6e16cf9468af72392added532f1c6813b1ea)。
- <Mod/> 网站：添加更新日志页面。

### 1.15.6 (2025-02-20) <Source to='https://github.com/yezhiyi9670/sparks-notation-1/tree/5b54cd0a5c57bd898bd8821ff122228b26b94018' />

- <New/> <Important/> 桌面版：现在开始为 GNU/Linux 系统提供预构建版本的下载。
- <Fix/> 构建流程：修复全新构建桌面应用时，出现目录不存在错误的问题。
- <Mod/> 修改概念名称「反复指令记号」→「后反复记号」，「反复目标记号」→「前反复记号」。
- <New/> 网站：现在支持搜索。本站所采用的搜索模块不借助第三方服务。
- <Mod/> 网站：风格改动。
  - 现在使用直角引号 `「` `」` 代替弯引号 `“` `”`，因为许多字体下弯引号容易分不清前后。
  - 修改字体。首选字体是 Noto Sans SC，若不存在，则采用用户在浏览器设置中选择的无衬线字体。
- <Fix/> 桌面版：为优化性能，现在采用 `asar` 打包部分资源文件。
- <New/> 桌面版：现在可以在设置中禁止检查更新，但不推荐。
- <Mod/> 当某一行开头恰好是某个跳房子记号的开头时，此处的小节序号现在不再隐藏，而是会正常显示且略向左偏移一段距离。
- <Mod/> 为简单起见，对于跨越多个碎片的跳房子记号，从第二个碎片开始可以将跳房子记号留空，即只写 `J:` 两个字符。
- <Fix/> 修复了省略小节上方的前置/后置小节线属性不显示的问题。
- <Fix/> 修复了空白小节上的前置/后置小节线属性即使不显示也仍然占据排版空间的问题。
- <Fix/> 修复了歌词的自定义标点功能对已知标点字符和 `%` `_` 字符无效的问题。

### 1.15.5 (2025-02-11) <Source to='https://github.com/yezhiyi9670/sparks-notation-1/tree/2b6a688803245ddc3432034d3ccc129b4fccbd18' />

- <Fix/> 网站：修复了字体加载网址不统一，从而导致的缓存性能问题。现在新的访客浏览一段时间主页后，将能够更快打开试用页面。
- <Mod/> 多声部乐谱中，变速现在只需要在其中一个声部中写出变速记号，而不需要在所有声部中都写出。
  - 变拍仍然需要在所有声部中写出。
- <Mod/> 在 `Frp:` 开头的行中使用除 `n` 和 `time_lining` 以外的不受支持的渲染属性，将会显示错误。
- <Mod/> 修改概念名称「音乐属性」→「乐理属性」。

### 1.15.4 (2025-02-11) <Source to='https://github.com/yezhiyi9670/sparks-notation-1/tree/65bc49225f6ac1a70de975b975d6e0c06dca791d' />

- <Fix/> 修复了音效试听时音画不同步较为严重的问题。
- <New/> 文本章节中的文本行在以 `|` 字符开头的前提下，现在还可以插入一个 `>` 字符来标记对齐点。
  - 一个文本章节中，所有带有对齐点的行都会在对齐点处对齐。这对创建正确的悬挂缩进很有用。
  - 所有不含对齐点的行仍然靠左对齐。
- <Mod/> 使用方括号属性指定序号的尾注，形如 `Df[1]: 这里的符号表示换气`，将会有正确的悬挂缩进。
- <Mod/> 现在弱起小节语法可以和减时线结合，占据非整数的时值。

### 1.15.3 (2025-01-24) <Source to='https://github.com/yezhiyi9670/sparks-notation-1/tree/e18b9427d4bf6e58cf3e144fb61cb8fdcff07646' />

- <Fix/> 修复了 `Df` 指令添加方括号属性会报错的问题。[（感谢 yueyinqiu 的反馈）](https://github.com/yezhiyi9670/sparks-notation-1/issues/4)

### 1.15.2 (2024-11-13) <Source to='https://github.com/yezhiyi9670/sparks-notation-1/tree/445b6e16cf9468af72392added532f1c6813b1ea' />

- <Mod/> 网站：首次打开试用页面时，将显示一个带有默认内容的文档，而非完全空白的文档。
- <Mod/> 第一行不再显示小节序号。
- <Mod/> 桌面版：新建文档时将创建一个带有默认内容的文档，而非完全空白的文档。
- <Mod/> 调整了音效试听中音符高亮的颜色。新的配色更加匀称和柔和。
- <New/> 小节序号现在可以通过 `font_sectionorder` 渲染属性指定字体。
- <Del/> 由于小节序号不再侵入第一个小节，不需要再采取操作避免第一个小节上方标注的文本与小节序号重叠。
- <Mod/> 小节序号不再侵入第一个小节上方的空间，而是靠右对齐到第一个小节的左边缘位置。
- <Fix/> <Important/> **重组了代码仓库结构。**
  - 内核、桌面版和网站现在合并到一个代码仓库中。原先的桌面版仓库由于包含 Releases，被重命名并作为新的代码仓库使用。另外两个仓库被归档并废弃。
  - 这也是网站和文档的源代码首次公开发布。

## 1.14.x

### 1.14.24 (2024-06-18) <Source to='https://github.com/yezhiyi9670/sparks-nmn-dev/tree/d90cc2dd9f4956bf3384abf028c770db242bba3a' />

- <Mod/> 更改了官网网址 `https://notation.sparkslab.art/`。

### 1.14.23 (2023-09-13) <Source to='https://github.com/yezhiyi9670/sparks-nmn-dev/tree/14f9dda92c99b20498da0e1f5cfe60e96e225e32' />

- <New/> 添加了「基调与拍速测定」工具。
- <New/> 添加了导出音效试听音频的功能，格式为 OGG。
- <Fix/> 修复了「锯齿」乐器的音高。
- <Mod/> 音效试听中的混音设置区域现在会按合理的顺序排列各声部。
- <New/> 添加了紧凑声部功能。
- <Mod/> 新的音符自动布局机制，对于多声部乐谱更加友好。
  - 可以通过使用 `legacy_positioning` 渲染属性回退到旧版机制。
- <New/> 将鼠标悬停在音效试听窗口的小节选择器上，现在可以看到从全曲开头到此小节结束的总时长。

### 1.14.17 (2023-07-23) <Source to='https://github.com/yezhiyi9670/sparks-nmn-dev/tree/bcf58914e25060c558889a964f2cccb1d8980aba' />

- <New/> 桌面版：添加导出 JSON 数据的功能。
- <Fix/> 修复字符串类型的指令行中括号不匹配会报错的问题。
- <New/> 添加新的转义序列 `\*`，转义为空字符串。
- <New/> 现在字符串类型的指令行，例如 `Dt` `Ds` `Df` 等，可以在内容中使用转义字符。
- <Mod/> 现在 `Df` 指令可以写在整个文件末尾。
- <Mod/> 通过修改字体文件，统一了各内置字体的行高、基线等数据。
  - 修改的具体内容说明位于源代码中字体文件夹内的 `modification.txt`。

### 1.14.13 (2023-07-20) <Source to='https://github.com/yezhiyi9670/sparks-nmn-dev/tree/e9ce0d44685b75bdd6e7840c267b85e07a0bb4d0' />

- <New/> 添加段标题类型的标记符号，形如 `h"A"`。
- <Mod/> 调整了音符的自动布局机制，现在不同时值的音符所占据宽度的差异应当更明显。
- <Fix/> 修复了不同谱面缩放下段标题方框的边距看起来不一致的问题。
- <Fix/> 修复了鼓点行中的小节线前置/后置属性即使不显示也会占据排版空间的问题。
- <Fix/> 修复了在 `1=?` 基调下，`8va` 和 `8vb` 跳房子记号不生效的问题。

### 1.14.10 (2023-07-19) <Source to='https://github.com/yezhiyi9670/sparks-nmn-dev/tree/a625e0ef2cb8cc42a432891b33fbcccab4e2bd68' />

- <Mod/> 修改了未标号歌词行的选择机制：现在不再根据当前反复迭代数进行选择，而是根据经过该小节的次数进行选择。
- <Fix/> 修复了播放时的音符高亮色块在不同的谱面缩放下看起来大小不一致的问题。
- <Fix/> 对于声部较多的乐谱，修复了播放时自动滚动的量。
- <New/> 为在线试用（Demo）页面添加了字体加载进度条。
- <Fix/> 修复了导出的 HTML 预览文件不能正确加载字体和样式的问题。
- <Fix/> 乐谱展示组件：优化了性能。

### 1.14.6 (2023-07-15) <Source to='https://github.com/yezhiyi9670/sparks-nmn-dev/tree/465754de07f34e589e943634bfb68c2fadfcdde8' />

- <New/> 添加了保存音效试听中的混音配置的功能。
- <New/> <Important/> **添加了音效试听与结构检查功能。**
  - 音效试听的快捷键：播放/暂停 - `K`；返回开头 - `R`；自动滚动 - `A`。
- <New/> 现在编辑器会对同一小节中各声部拍号或曲速不匹配的情况给出警告。
- <Mod/> 时值校验的色块在导出和打印时不再显示。
- <Fix/> 优化了渲染性能。
- <Mod/> 全局 `em` 单位现在默认是页面宽度的 $\frac{1}{122}$ 而非 $\frac{1}{124}$。此改动调节的是页面边距，不影响乐谱显示。

## 1.13.x

### 1.13.17 (2023-07-04) <Source to='https://github.com/yezhiyi9670/sparks-nmn-dev/tree/1c85b33f0b751b6a252e987ba704ed6f0149d71c' />

- <Mod/> 歌词中测量常见的全角标点宽度时，现在不再测量对应半角标点，而是取全角标点宽度的一半。

### 1.13.16 (2023-06-28) <Source to='https://github.com/yezhiyi9670/sparks-nmn-dev/tree/f94887a4ddfeaaaa5039ba3154b8b8783ea5ded0' />

- <New/> 为曲速标签增加更多功能。
  - 曲速现在允许使用带附点的二分、四分和八分音符表示，例如 `q.pm=71`。
  - 曲速现在允许添加模糊的文本，用来代替精确数值显示，例如 `spm=233/较快`。
- <Fix/> 修复字体对齐问题。
- <Fix/> 乐谱展示组件：修复乐谱展示时的布局问题。
- <Fix/> 修复乐谱渲染时超出页面宽度的问题。

### 1.13.11 (2023-06-24) <Source to='https://github.com/yezhiyi9670/sparks-nmn-dev/tree/a27f39aca7dc6c9b42be0820cab2d319dc3b36ea' />

这是第一个公开发布的版本。

</div>
