---
sidebar_position: 5
description: 小节，音符行和标记所共用的结构
---
import C from '@site/src/mdx'
import * as Cs from '@site/src/mdx/reference/previewedref'

# 小节序列、小节线 {#sections}

音符序列 `N` `Na` `Ns` 和标记 `F` `C` `A` `La` 的内容具有非常类似的格式，称为小节序列。本节介绍小节序列的描述格式。

## 小节与小节线 {#section-and-separator}

小节序列总而言之是若干由小节线隔开的小节，像是这样：

<C.ScoreExample>{
`1 1 5 5 | 6 6 5 - | 4 4 3 3 | 2 2 1 - |`
}</C.ScoreExample>

这里的分界线叫做小节线，而分界线中间的东西则是由音符、延时线构成的“小节”。

## 小节线 {#separator}

### 小节线类型 {#separator-type}

所有小节线如下：

<Cs.SeparatorsReference />

- 如须在一个碎片最开头的小节线上标注**后置属性**，则需要用到隐藏小节线。此处添加隐藏小节线不会对排版造成影响。
- 由于一些问题，目前反复指令记号和双侧反复记号的不完整小节版本无法正常显示虚线。
- 需要注意，小节线符号内有空格，并不影响小节线的解析。例如 `|||` 也可以写作 `| ||`。

<C.SpoilerAlert variant='caution' title='常见错误' desc={
	'上表的后三列规定了这些小节线能否处于一个小节序列的开头、中间或结尾。如果违反这些规则，编辑器将会显示警告，并且会导致一些未预期的后果。'
}>

<C.ScoreExample canLoad>{
`P: 1=C 4/4
Rp: n=5 // 这是为了让问题更加明显
====
N: 1 1 5 5 | 6 6 5 - | 4 4 3 3 | 2 2 1 -  // 这里缺失小节线
---
// highlight-next-line
N: | 5 5 4 4 | 3 3 2 - | 5 5 4 4 | 3 3 2 - |
---
N: 1 1 5 5 | 6 6 5 - | 4 4 3 3 | 2 2 1 - |||
`}</C.ScoreExample>

▲ 第四小节结束处的小节线被放到了第二个碎片开头。结果是第四小节结束处的小节线消失了。

<C.ScoreExample canLoad>{
`P: 1=C 4/4
====
// highlight-next-line
N: 1 1 5 5 | 6 6 5 - | 4 4 3 3 | 2 2 1 - ||:
// 解决方法：将反复目标记号移到下一行开头
---
N: 5 5 4 4 | 3 3 2 - | 5 5 4 4 | 3 3 2 - |
---
N: 1 1 5 5 | 6 6 5 - | 4 4 3 3 | 2 2 1 - |||
`}</C.ScoreExample>

▲ 第四小节结束处的反复目标记号写在了第一碎片末尾。结果是这个反复记号并没有显示出来。

<C.ScoreExample canLoad>{
`P: 1=C 4/4
====
// highlight-next-line
N: 1 1 5 5 | 6 6 5 - | 4 4 3 3 | 2 2 1 - :||:
// 解决方法：将双侧反复记号拆开，反复指令记号留在原位，反复目标记号放到下一个碎片开头。
---
N: 5 5 4 4 | 3 3 2 - | 5 5 4 4 | 3 3 2 - |
---
N: 1 1 5 5 | 6 6 5 - | 4 4 3 3 | 2 2 1 - |||
`}</C.ScoreExample>

▲ 第四小节结束处写了一个双侧反复记号，结果是只显示出了反复指令记号部分。

</C.SpoilerAlert>

曲谱 `N` `Na` 和替代旋律 `Ns` 中的小节常常需要用到多种小节线；而 `A` `La` 标记中的小节则只需要使用一般小节线，使用其他小节线效果不会有任何差别。

### 小节线属性 {#separator-attrs}

小节线可以通过添加括号来添加属性，像是这样：

<C.ScoreExample>{
`N: 1 1 5 5 {<...>}|[<...>]{<...>} 6 6 5 - | 4 4 3 3 | 2 2 1 - |||`
}</C.ScoreExample>

- 小节线前的花括号称为**前置属性**，显示在小节线左侧，这些属性实质上**属于上一个小节**。
- 小节线后的方括号为**上方属性**，显示在小节线上方或下方，属于小节线本身。
- 小节线后的花括号为**后置属性**，显示在小节线右侧，这些属性实质上**属于下一个小节**。
- 小节序列开头或末尾的小节线所使用的属性类型有限制。如果违反了限制，编辑器将会显示警告。
  - 对于用来显示的属性，小节序列开头的小节线不能写前置属性和上方属性，小节序列末尾的小节线不能写后置属性。
  - 对于转调、变拍和变速等，小节序列开头的小节线不能写前置属性，小节序列末尾的小节线不能写后置属性或上方属性。
- 当某一类属性为空时，可以省略其括号不写出。

<C.RealtimeScore efRange={1} children={
`// preserve-start
P: 1=C 4/4 qpm=120
====
// highlight-next-line
N: /{t=1} 1 1 1 1 ||["A"] 2 2 2 2 {"末尾减慢 "}||["B"]{" ", qpm=114} 3 3 3 3 |{qpm=110} 1 1 1 - |||
// preserve-end
A: 0 0 0 "  上方属性" | 0 0 " 前置属性" | "后置属性"
`
} />

小节线属性的具体内容见[下一节](/docs/reference/section-attrs)。

### 小节 {#section}

小节一般是由音符、延时线构成的序列，关于这些内容，请看[音符](/docs/reference/notes)章节。

此外，还有两种特殊的小节：

- 包含一个单词 `empty`，表示该小节为空（注意空白小节不能直接留空，一定要写入 `empty`）。
- 格式为 `omit` 或 `omit(<数值>)`，分别表示“(后略)”和“(省略<数值\>小节)”，小节编号会发生相应变化。
