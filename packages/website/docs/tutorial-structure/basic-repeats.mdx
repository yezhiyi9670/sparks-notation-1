---
sidebar_position: 1
description: 添加基本的反复记号、分段线及小节省略
---
import C from '@site/src/mdx'

# 反复记号、分段、省略 {#basic-repeats}

我们在小学二年级的时候就学过简谱中最基本的反复、分段与省略记号。在此，我们简单回顾并拓展一下。

## 特殊的小节线 {#special-separators}

### 小节线反复记号 {#separator-repeats}

最常见的反复记号是两种特殊的小节线，形似 `:||`（**反复指令记号**）和 `||:`（**反复目标记号**）。它们之间的部分就会被反复。在 Sparks NMN 中，它们记作 `:||` 和 `||:`（如果两者合并则记作**双侧反复记号** `:||:`），它们的[不完整小节](/docs/tutorial-basics/complicated-beats#incomplete-sections)版本分别是 `:/||`，`/||:` 和 `:/||:`。下面的例子来自小学课本中的《童心是小鸟》。

<C.RealtimeScore efRange={[25,31]} children={
`Dp: 来自小学四年级上册音乐课本
Dt: 童心是小鸟
Da[词]: 韩景连
Da[曲]: 平安俊
P: 1=bE 3/4 喜悦地
Rp: n=6 font_lyrics=Roman,CommonSerif/600/0.95
====
N: &lpr; 6 6.(2) | (45) 6 0 | 1e 5.(1) | (34) 5 0 |
---
N: (43)(21)(7d6d) | 5d 5.(2) | (43) 1 - | 1 - - &rpr; |
---
N: (31)(5d1)3 | 6 5 0 | 1e 6.(4) | (65) 5 - |
Lc: 我把小树苗栽到春天的故事里，
---
N: (31)(5d7d)2 | 4 3 0 | 6 5. (2) | (43) 3 - |
Lc: 我把小蜻蜓送回夏天的目光里，
---
N: (31)(5d1)3 | 6 5 (05) | 1e 6. (4) | (45) 6 - |
Lc: 我把小鸽子放飞在秋天的歌声里，
---
N: (51e)(55)3 | 4 2 0 | 7d 5d. (7d) | (21) 1 - |
Lc: 我把小雪人堆在冬天的童话里。
---
N: (35)(55)(63) | 5 - - | (24)(44)(31) | 2 - - |
Lc: 啦啦啦啦啦啦啦！ 啦啦啦啦啦啦啦！
// preserve-start
---
Frp: n=5
// highlight-next-line
N: ||: 6 6. (2) | (4^5^) 6 0 | 1e 5. (1) | (3^4^) 5 0 |
Lc: 童心是小%鸟，羽毛很美%丽，
---
N: (43)(21)(7d6d) | 5d 5.(2) |
Lc: 飞来飞去飞在四季的
---
J: 1.
// highlight-next-line
N: (43) 3 - :||
Lc: 怀抱里。
// preserve-end
---
J: 2.
Frp: n=7
N: (43) 1~ - | 1 - - | 3 - - | 5.(3)(65) | 5~ - - | 5~ - - | 5 0 0 |||
Lc: 怀抱里。 啦 啦 啦啦啦啦！
`
} />

这种反复记号的基本机制，就是遇到反复指令记号 `:||` 时，寻找其前面最近的反复目标记号 `||:` 进行跳转。如果没有，则回到开头。

:::caution 常见错误

小节线 `:||` 不能在碎片开头，小节线 `||:` 不能在碎片末尾。  
小节线 `:||:` 不能在开头或末尾（此时需要拆开书写）。  
违反此规则时，编辑器将显示警告。

:::

### 分段线 {#splitting-line}

在没有反复记号的位置，若要表示分段，可以将小节线改为分段线。分段线是两条粗细相同的竖线，写作 `||`。

<C.RealtimeScore efRange={7} children={
`Dp: 来自小学四年级上册音乐课本
Dt: 童心是小鸟
Da[词]: 韩景连
Da[曲]: 平安俊
P: 1=bE 3/4 喜悦地
Rp: n=6 font_lyrics=Roman,CommonSerif/600/0.95
// preserve-start
====
N: &lpr; 6 6.(2) | (45) 6 0 | 1e 5.(1) | (34) 5 0 |
---
// highlight-next-line
N: (43)(21)(7d6d) | 5d 5.(2) | (43) 1 - | 1 - - &rpr; ||
---
N: (31)(5d1)3 | 6 5 0 | 1e 6.(4) | (65) 5 - |
Lc: 我把小树苗栽到春天的故事里，
// preserve-end
---
N: (31)(5d7d)2 | 4 3 0 | 6 5. (2) | (43) 3 - |
Lc: 我把小蜻蜓送回夏天的目光里，
---
N: (31)(5d1)3 | 6 5 (05) | 1e 6. (4) | (45) 6 - |
Lc: 我把小鸽子放飞在秋天的歌声里，
---
N: (51e)(55)3 | 4 2 0 | 7d 5d. (7d) | (21) 1 - |
Lc: 我把小雪人堆在冬天的童话里。
---
N: (35)(55)(63) | 5 - - | (24)(44)(31) | 2 - - |
Lc: 啦啦啦啦啦啦啦！ 啦啦啦啦啦啦啦！
---
Frp: n=5
N: ||: 6 6. (2) | (4^5^) 6 0 | 1e 5. (1) | (3^4^) 5 0 |
Lc: 童心是小%鸟，羽毛很美%丽，
---
N: (43)(21)(7d6d) | 5d 5.(2) |
Lc: 飞来飞去飞在四季的
---
J: 1.
N: (43) 3 - :||
Lc: 怀抱里。
---
J: 2.
Frp: n=7
N: (43) 1~ - | 1 - - | 3 - - | 5.(3)(65) | 5~ - - | 5~ - - | 5 0 0 |||
Lc: 怀抱里。 啦 啦 啦啦啦啦！
`
} />

### 段落标记 {#label}

通过在小节线的上方属性（小节线后的方括号）中添加双引号引起的字符串（如 `"text"`），即可插入段落标记。**双引号不可省略**。

<C.RealtimeScore efRange={[7,25]} children={
`Dp: 来自小学四年级上册音乐课本
Dt: 童心是小鸟
Da[词]: 韩景连
Da[曲]: 平安俊
P: 1=bE 3/4 喜悦地
Rp: n=6 font_lyrics=Roman,CommonSerif/600/0.95
// preserve-start
====
N: &lpr; 6 6.(2) | (45) 6 0 | 1e 5.(1) | (34) 5 0 |
---
// highlight-next-line
N: (43)(21)(7d6d) | 5d 5.(2) | (43) 1 - | 1 - - &rpr; ||["A"]
---
N: (31)(5d1)3 | 6 5 0 | 1e 6.(4) | (65) 5 - |
Lc: 我把小树苗栽到春天的故事里，
---
N: (31)(5d7d)2 | 4 3 0 | 6 5. (2) | (43) 3 - |
Lc: 我把小蜻蜓送回夏天的目光里，
---
N: (31)(5d1)3 | 6 5 (05) | 1e 6. (4) | (45) 6 - |
Lc: 我把小鸽子放飞在秋天的歌声里，
---
N: (51e)(55)3 | 4 2 0 | 7d 5d. (7d) | (21) 1 - |
Lc: 我把小雪人堆在冬天的童话里。
---
// highlight-next-line
N: (35)(55)(63) | 5 - - | (24)(44)(31) | 2 - - |["B"]
Lc: 啦啦啦啦啦啦啦！ 啦啦啦啦啦啦啦！
---
Frp: n=5
N: ||: 6 6. (2) | (4^5^) 6 0 | 1e 5. (1) | (3^4^) 5 0 |
Lc: 童心是小%鸟，羽毛很美%丽，
// preserve-end
---
N: (43)(21)(7d6d) | 5d 5.(2) |
Lc: 飞来飞去飞在四季的
---
J: 1.
N: (43) 3 - :||
Lc: 怀抱里。
---
J: 2.
Frp: n=7
N: (43) 1~ - | 1 - - | 3 - - | 5.(3)(65) | 5~ - - | 5~ - - | 5 0 0 |||
Lc: 怀抱里。 啦 啦 啦啦啦啦！
`
} />

也可以使用带下标形式，形如 `"B"_"1"`。若[缩小曲谱行前的间距](/docs/tutorial-layout/adjusting-margin#all-options)，这种段落标记在打印时可能出现异常。

另一种写在小节开头处的段落标记（也是音乐课本上的那种）用后置属性的方式表示，写法是 `["A"]`（不带下标）或 `["A"_"1"]`（带下标）。对于不带下标的情况，**双引号可以省略**。

<C.RealtimeScore efRange={[7,25]} children={
`Dp: 来自小学四年级上册音乐课本
Dt: 童心是小鸟
Da[词]: 韩景连
Da[曲]: 平安俊
P: 1=bE 3/4 喜悦地
Rp: n=6 font_lyrics=Roman,CommonSerif/600/0.95
// preserve-start
====
N: &lpr; 6 6.(2) | (45) 6 0 | 1e 5.(1) | (34) 5 0 |
---
N: (43)(21)(7d6d) | 5d 5.(2) | (43) 1 - | 1 - - &rpr; ||
---
// highlight-next-line
N: /{[A]} (31)(5d1)3 | 6 5 0 | 1e 6.(4) | (65) 5 - |
Lc: 我把小树苗栽到春天的故事里，
---
N: (31)(5d7d)2 | 4 3 0 | 6 5. (2) | (43) 3 - |
Lc: 我把小蜻蜓送回夏天的目光里，
---
N: (31)(5d1)3 | 6 5 (05) | 1e 6. (4) | (45) 6 - |
Lc: 我把小鸽子放飞在秋天的歌声里，
---
N: (51e)(55)3 | 4 2 0 | 7d 5d. (7d) | (21) 1 - |
Lc: 我把小雪人堆在冬天的童话里。
---
N: (35)(55)(63) | 5 - - | (24)(44)(31) | 2 - - |
Lc: 啦啦啦啦啦啦啦！ 啦啦啦啦啦啦啦！
---
Frp: n=5
// highlight-next-line
N: ||:{[B]} 6 6. (2) | (4^5^) 6 0 | 1e 5. (1) | (3^4^) 5 0 |
Lc: 童心是小%鸟，羽毛很美%丽，
// preserve-end
---
N: (43)(21)(7d6d) | 5d 5.(2) |
Lc: 飞来飞去飞在四季的
---
J: 1.
N: (43) 3 - :||
Lc: 怀抱里。
---
J: 2.
Frp: n=7
N: (43) 1~ - | 1 - - | 3 - - | 5.(3)(65) | 5~ - - | 5~ - - | 5 0 0 |||
Lc: 怀抱里。 啦 啦 啦啦啦啦！
`
} />

## 结构反复记号 {#structure-repeats}

有一组更加传统反复记号，形如 `D.S.` 和 `D.C.` 等，称为结构反复记号。

结构反复记号有：`$` - 标记；`D.C.` - 跳到开头；`D.S.` - 跳到标记；`@` - 成对出现，表示在第二次反复时跳过中间的片段；`Fine.` - 表示第二次反复时在这里结束歌曲。它们均可以作为小节线属性，均能够放在前置（小节线前的花括号）、上方（小节线后的方括号）、后置（小节线后的花括号）位置。

先看一个简单的片段：

<C.RealtimeScore efRange={1} canLoad children={
`P: 1=? 4/4
====
// highlight-next-line
N: 3 (31)(23) 2 |[$] (12)(35)(35)(43) | (43)(21)(7d2)(31) {D.S.}| (7d1)(7d1) 1 - |||
`
} />

首先奏唱 1-3 小节，然后遇到 `D.S.` 记号，故返回标记，奏唱 2-4 小节，并结束。

显然，使用更加现代的方式，这个片段可以改写成下面的形式：

<C.RealtimeScore efRange={1} children={
`P: 1=? 4/4
====
// highlight-next-line
N: 3 (31)(23) 2 ||: (12)(35)(35)(43) | (43)(21)(7d2)(31) :|| (7d1)(7d1) 1 - |||
`
} />

这么看来，在大多数情况下，结构反复记号不会被用到，因为它们本来就已经被更加明确且容易辨识的特殊小节线取代。然而，有时候，两个反复区域出现交叉的情况，这时不得不使用传统的结构反复记号。下面例子为歌曲《月亮代表我的心》。

export const nmnCode1721 = `Dt: 月亮代表我的心
Ds: (抄写岭南印象所记乐谱)
Da[词]: 孙仪
Da[曲]: 翁清溪
P: 1=#C 4/4 qpm=78
Rp: n=5 font_lyrics=Roman,CommonSerif/600/0.95
====
N: &lpr; 5~ - (53)(21) | 3 - - - | 6~ - (64)(21) |
---
N: 7d - - &rpr; (05d) | 1[((5d))].(3) 5[((3))].(1) | 7d. (3) 5. (5) | 6[((5))]. (7)1e.(6[wav]) | 5[((6))] - - (32) |
Lc: % 你问我爱你有多深，我爱你有几分，我的
---
N: 1.(1) 1 (32) | 1.(1) 1 (23[((2))]) | 2[((3))]. (1)6d(2^3^) | 2[((3))] - - (05d) |
Lc: 情也真，我的爱也真，月亮代表我的%心。你
---
N: 1[((5d))].(3) 5[((3))].(1) | 7d.(3) 5.(5) | 6[((5))].(7)1e.(6[wav]) | 5[((6))] - - (32) |
Lc: 问我爱你有多深，我爱你有几分，我的
// preserve-start
---
N: 1. (1)1 (32) | 1.(1)1 (23[((2))]) | 2[((3))].(6d) 7d (1^2^) | 1[((2))] - - (3^5^) |
Lc: 情不移，我的爱不变，月亮代表我的%心。轻%
---
// highlight-next-line
N: ||: 3.(2) 1 5 | 7d - - (6d7d) | 6d.(7d[((6d))]) 6d 5d | 3 - - 5 |
Lc: 轻的一个吻，已经打动我的心。深
---
N: 3.(2) 1 5 | 7d - - (6d7d) | 1.(1)1.((2^3^)) | 2[((3)), wav] - - (05d) |
Lc: 深的一段情，叫我思念到如%今。你
---
N: 1[((5d))].(3) 5[((3))].(1) | 7d.(3) 5.(5) | 6[((5))].(7)1e.(6[wav]) | 5[((6))] - - (32) |
Lc: 问我爱你有多深，我爱你有几分。你去
---
// highlight-next-line
N: /{$} 1.(1) 1 (32) | 1.(1) 1 (23) |
Lc: 想一想，你去看一看，月亮
---
J: 1.
N: 2[((3))].(6d)7d (1^2^) | 1[((2))] - - &lpr; 5d |
Lc: 代表我的%心。
---
J:
N: 1.(3) 5.(1) | 7d.(3) 5.(5) | 6.(7)1e.(6) | 5 - - (32) | 1.(1)1 (32) | 1.(1)1(23)|2.(6d)7d (12) |
---
J:
// highlight-next-line
N: 1 - - &rpr; (3^5^) :||
Lc: % 轻
---
J: 2.
// highlight-next-line
N: /{p=0.8} 2[((3))].(6d)7d (1^2^) | 1[((2))] - - (32) {D.S.}||
Lc: 代表我的%心。你去
---
J: "结束句"
N: 2[((3))].(6d)7d (1^2^) | 1[((2))] - - - | &lpr; 6d (7d6d) b6d - | 5d - - - &rpr; |||
Lc: 代表我的%心。
// preserve-end
`

<C.RealtimeScore efRange={[1,46]} noCode children={nmnCode1721} />

此歌曲的奏唱顺序：第一遍 1-44 小节，第二遍 (21-34, 45-46) 小节，第三遍 (33-34, 47-50) 小节。这里结构反复记号将不能改成小节线反复记号，因为这样会导致第一遍结束后跳到第 33 小节，而非第 21 小节。

<C.ScoreExample canLoad children={nmnCode1721} />

这样的反复结构在流行歌曲中实际上非常常见。我们认为，使用结构反复记号解决这种结构只是一种权宜之计，并非什么很好的解决方法。因此，Sparks NMN 提供了“条件反复”语法。条件反复的含义，将在[反复迭代数](/docs/tutorial-structure/understanding-iter)章节中严谨地介绍。

<C.RealtimeScore efRange={[16,46]} children={
`Dt: 月亮代表我的心
Ds: (抄写岭南印象所记乐谱)
Da[词]: 孙仪
Da[曲]: 翁清溪
P: 1=#C 4/4 qpm=78
Rp: n=5 font_lyrics=Roman,CommonSerif/600/0.95
====
N: &lpr; 5~ - (53)(21) | 3 - - - | 6~ - (64)(21) |
---
N: 7d - - &rpr; (05d) | 1[((5d))].(3) 5[((3))].(1) | 7d. (3) 5. (5) | 6[((5))]. (7)1e.(6[wav]) | 5[((6))] - - (32) |
Lc: % 你问我爱你有多深，我爱你有几分，我的
---
N: 1.(1) 1 (32) | 1.(1) 1 (23[((2))]) | 2[((3))]. (1)6d(2^3^) | 2[((3))] - - (05d) |
Lc: 情也真，我的爱也真，月亮代表我的%心。你
---
N: 1[((5d))].(3) 5[((3))].(1) | 7d.(3) 5.(5) | 6[((5))].(7)1e.(6[wav]) | 5[((6))] - - (32) |
Lc: 问我爱你有多深，我爱你有几分，我的
---
N: 1. (1)1 (32) | 1.(1)1 (23[((2))]) | 2[((3))].(6d) 7d (1^2^) | 1[((2))] - - (3^5^) |
Lc: 情不移，我的爱不变，月亮代表我的%心。轻%
---
N: ||: 3.(2) 1 5 | 7d - - (6d7d) | 6d.(7d[((6d))]) 6d 5d | 3 - - 5 |
Lc: 轻的一个吻，已经打动我的心。深
---
N: 3.(2) 1 5 | 7d - - (6d7d) | 1.(1)1.((2^3^)) | 2[((3)), wav] - - (05d) |
Lc: 深的一段情，叫我思念到如%今。你
---
N: 1[((5d))].(3) 5[((3))].(1) | 7d.(3) 5.(5) | 6[((5))].(7)1e.(6[wav]) | 5[((6))] - - (32) |
Lc: 问我爱你有多深，我爱你有几分。你去
// preserve-start
---
// highlight-next-line
N: ||:{3.} 1.(1) 1 (32) | 1.(1) 1 (23) |
Lc: 想一想，你去看一看，月亮
---
J: 1.
N: 2[((3))].(6d)7d (1^2^) | 1[((2))] - - &lpr; 5d |
Lc: 代表我的%心。
---
J:
N: 1.(3) 5.(1) | 7d.(3) 5.(5) | 6.(7)1e.(6) | 5 - - (32) | 1.(1)1 (32) | 1.(1)1(23)|2.(6d)7d (12) |
---
J:
N: 1 - - &rpr; (3^5^) :||
Lc: % 轻
---
J: 2.
// highlight-next-line
N: /{p=0.8} 2[((3))].(6d)7d (1^2^) | 1[((2))] - - (32) :||
Lc: 代表我的%心。你去
---
J: "结束句"
N: /{p=0.8} 2[((3))].(6d)7d (1^2^) | 1[((2))] - - - | &lpr; 6d (7d6d) b6d - | 5d - - - &rpr; |||
Lc: 代表我的%心。
// preserve-end
`
} />

注意到这里确实将结构反复记号改成了小节线反复记号，但是第 33 小节前的反复记号上加注了 `3.`，表示该反复记号仅在第三遍时有效。这样的记号并不难懂，对初学者造成的困惑也显然低于结构反复记号，因而值得提倡。

反复迭代数模型将在稍后详细介绍。

## 省略小节 {#omit}

省略小节，是指略去一个或多个小节的内容，并将它们缩略进一个小节的空间。缩略具体有这两种形式：

- 略去某 $n$ 个小节的内容，缩略到一个小节的空间中。记作一条横杠，上面标注数字 $n$。
- 略去某一点之后的所有内容，记作“(后略)”。

它们的写法分别是 `omit` 和 `omit(n)`。

<C.RealtimeScore efRange={[1,7]} children={
`P: 1=C 4/4
====
// highlight-next-line
N: 7d. (6d)7d 1 | #5d 4 3 0 | (3)3 (3)(23)2 | omit(3) |
---
// highlight-next-line
N: (1)1 (1)(7d1)(7d0) | (7d6d)(6d#5d) 3d 4d | 3d.(3d) (3d1)7d | omit / 
`
} />

使用 `omit(n)` 记号时，小节序号将会发生相应的变化。

## 接下来... {#next}

我们知道，乐谱中许多地方会用到“第几遍”的标号，例如在多行歌词和跳房子记号中。当一份乐谱中出现多组多行歌词或跳房子记号时，不同人标号的方法可能会不一样，并且目前最常见的方法并不足以被推广以应对复杂的曲式结构。因此，接下来我们将介绍 Sparks NMN 推荐采用的标号方式——**反复迭代数**。这是一种规则简单、易于理解、容易推广且不会产生歧义与混淆的方式。

采用别的标号方式，不影响乐谱显示的正确性。但是，“音效试听与结构检查”功能依赖于**反复迭代数**标号法，如果采用其他标号方式，将不能给出正确的曲式结构。
